/*!build time : 2015-04-15 6:37:49 PM*/
KISSY.add("kg/uploader/3.0.2/plugins/ajbridge/ajbridge",function(a,b,c){function d(c,f,j){c=c.replace(e,""),f=b._normalize(f||{});var k=this,l=e+c,m=function(b){return b.status<1?void k.fire("failed",{data:b}):(a.mix(k,b),void(b.dynamic&&f.src||k.activate()))};f.id=f.id||a.guid(g),d.instances[f.id]=k,f.src&&(f.params.allowscriptaccess="always",f.params.flashvars=a.merge(f.params.flashvars,{jsEntry:i,swfID:f.id})),j?k.__args=[l,f,m]:a.later(b.add,h,!1,b,[l,f,m])}var e="#",f="1.0.15",g="ks-ajb-",h=100,i="KISSY.AJBridge.eventHandler";return a.mix(d,{version:f,instances:{},eventHandler:function(a,b){var c=d.instances[a];c&&c.__eventHandler(a,b)},augment:function(b,c){a.isString(c)&&(c=[c]),a.isArray(c)&&a.each(c,function(c){b.prototype[c]=function(){try{return this.callSWF(c,a.makeArray(arguments))}catch(b){this.fire("error",{message:b})}}})}}),a.augment(d,c.Target,{init:function(){this.__args&&(b.add.apply(b,this.__args),this.__args=null,delete this.__args)},__eventHandler:function(b,c){var d=this,e=c.type;switch(c.id=b,e){case"log":a.log(c.message);break;default:d.fire(e,c)}},callSWF:function(a,b){var c=this;b=b||[];try{if(c.swf[a])return c.swf[a].apply(c.swf,b)}catch(d){var e="";return 0!==b.length&&(e="'"+b.join("','")+"'"),new Function("self","return self.swf."+a+"("+e+");")(c)}}}),d.augment(d,["activate","getReady","getCoreVersion"]),window.AJBridge=a.AJBridge=d,d},{requires:["kg/flash/2.0.0/index","event"]}),KISSY.add("kg/uploader/3.0.2/plugins/ajbridge/uploader",function(a,b,c){function d(b,c){c=c||{};var e={};a.each(["ds","dsp","btn","hand"],function(a){a in c&&(e[a]=c[a])}),c.params=c.params||{},c.params.flashvars=a.merge(c.params.flashvars,e),d.superclass.constructor.call(this,b,c)}return a.extend(d,c),c.augment(d,["setFileFilters","filter","setAllowMultipleFiles","multifile","browse","upload","uploadAll","cancel","getFile","removeFile","lock","unlock","setBtnMode","useHand","clear"]),d.version="1.0.1",c.Uploader=d,c.Uploader},{requires:["kg/flash/2.0.0/index","./ajbridge"]}),KISSY.add("kg/uploader/3.0.2/button/swfButton",function(a,b,c,d){function e(b,c){var d=this;c=a.merge({target:g(b)},c),e.superclass.constructor.call(d,c)}var f="",g=b.all,h="swf-uploader-wrapper-";return a.mix(e,{event:{RENDER:"render",CHANGE:"change",MOUSE_OVER:"mouseOver",MOUSE_DOWN:"mouseDown",MOUSE_UP:"mouseUp",MOUSE_OUT:"mouseOut",CLICK:"click"}}),a.extend(e,c,{render:function(){var a,b=this,c=b.get("target"),d=b.get("multiple"),f=b.get("fileFilters");c.css("position","relative"),b.set("swfWrapper",b._createSwfWrapper()),b._setFlashSizeConfig(),a=b._initSwfUploader(),a.on("contentReady",function(){a.isContent||(a.isContent=!0,a.browse(d,f),b._bindBtnEvent(),a.on("fileSelect",b._changeHandler,b),b._setDisabled(b.get("disabled")),b.fire(e.event.RENDER))},b);var g=b.get("srcFileInput");return g&&g.length&&g.remove(),b},_createSwfWrapper:function(){var b=this,c=b.get("target"),d=b.get("tpl"),e=b.get("swfWrapperId")!=f&&b.get("swfWrapperId")||h+a.guid(),i=a.substitute(d,{id:e});return b.set("swfWrapperId",e),g(i).appendTo(c)},_initSwfUploader:function(){var b,c=this,e=c.get("flash"),f=c.get("swfWrapperId");a.mix(e,{id:"swfUploader"+a.guid()});try{b=new d(f,e),c.set("swfUploader",b)}catch(g){}return b},_bindBtnEvent:function(){var b=this,c=e.event,d=b.get("swfUploader");return d?(a.each(c,function(a){d.on(a,function(){b.fire(a)},b)}),b):!1},_setFlashSizeConfig:function(){var b=this,c=b.get("flash"),d=(b.get("target"),b.get("size"));a.isEmptyObject(d)||a.mix(c.attrs,d),b.set("flash",c)},_changeHandler:function(a){var b=this;if(b.get("swfUploader").id==a.id){var c=a.fileList;b.fire(e.event.CHANGE,{files:c})}},_setDisabled:function(b){var c=this,d=c.get("swfUploader"),e=c.get("cls"),f=e.disabled,g=c.get("target"),h=c.get("swfWrapper");return d&&a.isBoolean(b)?(b?(g.addClass(f),h.css("top","-3000px")):(g.removeClass(f),h.css("top",0)),b):!1},show:function(){var a=this,b=a.get("target");b.show()},hide:function(){var a=this,b=a.get("target");b.hide()}},{ATTRS:{target:{value:f},swfWrapper:{value:f},swfWrapperId:{value:f},tpl:{value:'<div id="{id}" class="uploader-button-swf" style="position: absolute;top:0;left:0;z-index:2000;"></div>'},multiple:{value:!0,setter:function(a){var b=this,c=b.get("swfUploader");return c&&c.multifile(a),a}},fileFilters:{value:[],setter:function(b){var c=this,d=c.get("swfUploader");return a.isObject(b)&&(b=[b]),d&&a.isArray(b)&&a.later(function(){d.filter(b)},800),b}},disabled:{value:!1,setter:function(a){var b=this,c=b.get("swfUploader");return c&&b._setDisabled(a),a}},cls:{value:{disabled:"uploader-button-disabled"}},size:{value:{}},flash:{value:{src:"//g.tbcdn.cn/kg/uploader/2.0.0/plugins/ajbridge/uploader.swf",id:"swfUploader",params:{bgcolor:"#fff",wmode:"transparent"},attrs:{width:400,height:400},hand:!0,btn:!0}},swfUploader:{value:f},srcFileInput:{value:f}}}),e},{requires:["node","base","../plugins/ajbridge/uploader"]});